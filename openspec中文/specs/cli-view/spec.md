# cli-view 规范

## 目的

`openspec view` 命令提供 OpenSpec 项目状态的全面仪表板视图，以统一、视觉吸引人的格式显示规范、变更和进度指标，帮助开发人员快速了解项目状态。

## 要求
### 要求：仪表板显示

系统应提供显示规范和变更仪表板概览的 `view` 命令。

#### 场景：基本仪表板显示

- **当** 用户运行 `openspec view` 时
- **则** 系统显示格式化的仪表板，其中包含摘要、活动变更、已完成变更和规范的部分

#### 场景：无 OpenSpec 目录

- **当** 用户在无 OpenSpec 的目录中运行 `openspec view` 时
- **则** 系统显示错误消息 "✗ 未找到 openspec 目录"

### 要求：摘要部分

仪表板应显示包含关键项目指标的摘要部分。

#### 场景：完整摘要显示

- **当** 使用规范和变更渲染仪表板时
- **则** 系统显示规范和需求的总数
- **并** 显示正在进行中的活动变更数量
- **并** 显示已完成变更的数量
- **并** 显示整体任务进度百分比

#### 场景：空项目摘要

- **当** 不存在规范或变更时
- **则** 摘要显示所有指标的零计数

### 要求：活动变更显示

仪表板应显示带有视觉进度指示器的活动变更。

#### 场景：按完成百分比排序的活动变更

- **当** 显示具有进度信息的多个活动变更时
- **则** 按完成百分比升序列出它们，以便 0% 的项目首先出现
- **并** 将缺失的进度值视为 0% 进行排序
- **并** 按变更标识符升序字母顺序打破平局，以保持输出确定性

### 要求：已完成变更显示

仪表板应在单独的部分中列出已完成变更。

#### 场景：已完成变更列表

- **当** 存在已完成变更（所有任务完成）时
- **则** 系统在专用部分中显示它们，并带有复选标记指示器

#### 场景：混合完成状态

- **当** 一些变更已完成而其他变更处于活动状态时
- **则** 系统将它们分离到适当的部分

### 要求：规范显示

仪表板应按需求计数显示排序的规范。

#### 场景：带有计数的规范列表

- **当** 项目中存在规范时
- **则** 系统显示按需求计数（降序）排序的规范，并带有计数标签

#### 场景：具有解析错误的规范

- **当** 无法解析规范文件时
- **则** 系统将其包含在内，需求计数为 0

### 要求：视觉格式化

仪表板应使用一致的颜色和符号进行视觉格式化。

#### 场景：颜色编码

- **当** 显示仪表板元素时
- **则** 系统使用青色表示规范项目
- **并** 黄色表示活动变更
- **并** 绿色表示已完成项目
- **并** 暗灰色表示补充文本

#### 场景：进度条渲染

- **当** 显示进度条时
- **则** 系统使用填充块（█）表示已完成部分，使用浅块（░）表示剩余部分

### 要求：错误处理

视图命令应优雅地处理错误。

#### 场景：文件系统错误

- **当** 文件系统操作失败时
- **则** 系统继续使用可用数据，并省略不可访问的项目

#### 场景：无效数据结构

- **当** 规范或变更具有无效格式时
- **则** 系统跳过无效项目并继续渲染