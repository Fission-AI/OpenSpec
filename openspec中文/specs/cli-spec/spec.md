# cli-spec 规范

## 目的
待定 - 由归档变更 add-interactive-show-command 创建。归档后更新目的。

## 要求
### 要求：交互式规范显示

规范显示命令应在未提供规范 ID 时支持交互式选择。

#### 场景：显示命令的交互式规范选择

- **当** 执行不带参数的 `openspec spec show` 时
- **则** 显示可用规范的交互式列表
- **并** 允许用户选择要显示的规范
- **并** 显示所选规范内容
- **并** 保持所有现有的显示选项（--json、--requirements、--no-scenarios、-r）

#### 场景：非交互式回退保持当前行为

- **假设** 标准输入不是 TTY 或提供了 `--no-interactive` 或设置了环境变量 `OPEN_SPEC_INTERACTIVE=0`
- **当** 执行不带规范 ID 的 `openspec spec show` 时
- **则** 不进行交互式提示
- **并** 打印缺失规范 ID 的现有错误消息
- **并** 设置非零退出代码

### 要求：规范命令

系统应提供带有子命令的 `spec` 命令，用于显示、列出和验证规范。

#### 场景：以 JSON 格式显示规范

- **当** 执行 `openspec spec show init --json` 时
- **则** 解析 Markdown 规范文件
- **并** 分层提取标题和内容
- **并** 将有效的 JSON 输出到标准输出

#### 场景：列出所有规范

- **当** 执行 `openspec spec list` 时
- **则** 扫描 openspec/specs 目录
- **并** 返回所有可用功能的列表
- **并** 支持使用 `--json` 标志的 JSON 输出

#### 场景：过滤规范内容

- **当** 执行 `openspec spec show init --requirements` 时
- **则** 仅显示需求名称和 SHALL 语句
- **并** 排除场景内容

#### 场景：验证规范结构

- **当** 执行 `openspec spec validate init` 时
- **则** 解析规范文件
- **并** 根据 Zod 模式进行验证
- **并** 报告任何结构问题

### 要求：JSON 模式定义

系统应定义准确表示规范结构的 Zod 模式，用于运行时验证。

#### 场景：模式验证

- **当** 将规范解析为 JSON 时
- **则** 使用 Zod 模式验证结构
- **并** 确保所有必需字段都存在
- **并** 为验证失败提供清晰的错误消息

### 要求：交互式规范验证

规范验证命令应在未提供规范 ID 时支持交互式选择。

#### 场景：验证命令的交互式规范选择

- **当** 执行不带参数的 `openspec spec validate` 时
- **则** 显示可用规范的交互式列表
- **并** 允许用户选择要验证的规范
- **并** 验证所选规范
- **并** 保持所有现有的验证选项（--strict、--json）

#### 场景：非交互式回退保持当前行为

- **假设** 标准输入不是 TTY 或提供了 `--no-interactive` 或设置了环境变量 `OPEN_SPEC_INTERACTIVE=0`
- **当** 执行不带规范 ID 的 `openspec spec validate` 时
- **则** 不进行交互式提示
- **并** 打印缺失规范 ID 的现有错误消息
- **并** 设置非零退出代码