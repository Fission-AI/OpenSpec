# CLI 归档命令 - 变更

## 修改后的要求

### 要求：规范更新过程

在将变更移至归档之前，命令应将增量变更应用到主规范以反映部署的现实。

#### 场景：应用增量变更

- **当** 归档带有基于增量的规范的变更时
- **则** 解析并应用在 openspec-conventions 中定义的增量变更
- **并且** 在应用前验证所有操作

#### 场景：验证增量变更

- **当** 处理增量变更时
- **则** 执行在 openspec-conventions 中指定的验证
- **并且** 如果验证失败，显示具体错误并中止

#### 场景：冲突检测

- **当** 应用增量会创建重复的要求标题时
- **则** 以显示冲突的错误消息中止
- **并且** 建议手动解决

## 新增要求

### 要求：显示输出

命令应提供关于增量操作的清晰反馈。

#### 场景：显示增量应用

- **当** 应用增量变更时
- **则** 为每个规范显示：
  - 添加的要求数量
  - 修改的要求数量
  - 删除的要求数量
  - 重命名的要求数量
- **并且** 使用在 openspec-conventions 中定义的标准输出符号 (+ ~ - →)：
  ```
  应用变更到 specs/user-auth/spec.md：
    + 2 添加
    ~ 3 修改
    - 1 删除
    → 1 重命名
  ```